<!DOCTYPE html>
<!--
================================================================================
UNIMARKET - PRODUCTS/SHOP PAGE (products.html)
================================================================================
PURPOSE: Browse, search, and filter products from all sellers
FEATURES:
- Product grid with images and basic info
- Search by product name/description
- Filter by category, price range, condition
- Responsive design (mobile, tablet, desktop)
- Loading indicator while fetching products

MAIN SECTIONS:
1. Header/Navigation (responsive navbar)
2. Filters Sidebar (left side):
   - Category filter (dropdown)
   - Price range slider (₦0-₦10,000)
   - Condition filter (New, Like New, Good, Fair)
3. Products Grid (main content):
   - Product cards with image, name, price, meta info
   - Bookmark button (wishlist)
   - Click card to view product details
4. Mobile: Filters hidden by default (toggle button)

API ENDPOINT: backend/main.py (lines 372-430) GET /api/products
QUERY PARAMETERS:
- search (string): Search product names/descriptions
- category (string): Filter by category
- priceMin (integer): Minimum price
- priceMax (integer): Maximum price
- condition (string): Filter by condition
- skip (integer): Pagination offset (default 0)
- limit (integer): Items per page (default 20)

RESPONSE: Array of product objects with:
- id, name, description, price
- images (with URLs)
- seller (with name, username, profile picture)
- category
- condition, size, color
- created_at, updated_at

JAVASCRIPT LOGIC (find in this file):
- Fetch products from API on page load
- Apply filters: category, price range, condition
- Search products: Real-time filtering
- Build product grid: Dynamic HTML generation
- Load indicator: Shows spinner while loading
- Pagination: Skip/limit for lazy loading
- Bookmark toggle: Save/unsave products (requires authentication)

FILTERING LOGIC:
1. Category filter: dropdown with categories
2. Price range: Slider with min/max values
3. Condition: Checkbox filter
4. Search: Text input with real-time filtering
5. All filters combinable (AND logic)

PRODUCT CARDS SHOW:
- Primary image (first image from product)
- Product name
- Price in Nigerian Naira (₦)
- Meta info (comments count, location)
- Bookmark button (save to wishlist)

RESPONSIVE DESIGN:
- Mobile: 1 column (full width)
- Tablet: 2 columns
- Desktop: 4 columns
- Filters toggle on mobile (hidden by default)

SECURITY:
- Bookmark requires authenticated user (JWT token)
- If not logged in: Redirect to login on bookmark click
- Comments feature placeholder (future)

EMPTY STATE:
- "No products found" message if no results
- "View All Products" link to clear filters

NEXT STEPS FROM HERE:
- Click product → product-detail.html
- Click Bookmark → Adds to saved items (requires login)
- Change filter → Re-fetch products from API
- Type in search → Real-time filtering
- New Listing → Redirect to sell.html (requires login)
================================================================================
-->
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop Products - UniMarket</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/products.css">
    <link rel="stylesheet" href="css/loader.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Socket.IO Client Library for real-time messaging -->
    <script src="https://cdn.socket.io/4.8.0/socket.io.min.js"></script>
</head>

<body>

    <!-- Loader -->
    <div class="loader-container" id="loader">
        <div>
            <div class="spinner"></div>
            <p class="loader-text loader-message">Loading products...</p>
        </div>
    </div>

    <!-- Header -->
    <header class="site-header">
        <div class="container">
            <a href="index.html" class="logo">UniMarket</a>

            <nav class="nav-links">
                <!-- Shop Dropdown -->
                <div class="nav-dropdown">
                    <button class="nav-link nav-dropdown-trigger">
                        Shop
                        <i data-lucide="chevron-down" class="dropdown-icon"></i>
                    </button>
                    <div class="dropdown-menu">
                        <a href="products.html" class="dropdown-item">All Products</a>
                        <div class="dropdown-separator"></div>
                        <span class="dropdown-label">Categories</span>
                        <a href="products.html?category=Clothing" class="dropdown-item">Clothing</a>
                        <a href="products.html?category=Furniture" class="dropdown-item">Furniture</a>
                        <a href="products.html?category=Books" class="dropdown-item">Books</a>
                        <a href="products.html?category=Electronics" class="dropdown-item">Electronics</a>
                        <a href="products.html?category=Other" class="dropdown-item">Other</a>
                    </div>
                </div>

                <a href="about.html" class="nav-link">About</a>
            </nav>

            <div class="search-bar">
                <i data-lucide="search" class="search-icon"></i>
                <input type="text" class="input input-pill" placeholder="Search for textbooks, electronics...">
            </div>

            <div class="user-actions">
                <!-- Logged Out State -->
                <div id="logged-out-actions">
                    <a href="login.html" class="nav-link">Log In</a>
                    <a href="signup-select-university.html" class="btn btn-primary">Sign Up</a>
                </div>
                
                <!-- Logged In State -->
                <div id="logged-in-actions" class="hidden" style="display: flex; gap: 1rem; align-items: center;">
                    <a href="messages.html" class="btn-icon btn-ghost nav-icon" title="Messages">
                        <i data-lucide="message-square"></i>
                        <span class="notification-badge hidden" id="message-badge">0</span>
                    </a>
                    <a href="saved-items.html" class="btn-icon btn-ghost nav-icon" title="Saved Items">
                        <i data-lucide="bookmark"></i>
                    </a>
                    <div class="profile-dropdown" style="position: relative;">
                        <button class="btn-icon btn-ghost nav-icon profile-dropdown-trigger" title="Profile">
                            <i data-lucide="user"></i>
                        </button>
                        <div class="profile-dropdown-menu">
                            <a href="profile.html" class="dropdown-item">View Profile</a>
                            <button onclick="logout()" class="dropdown-item logout-btn">Log Out</button>
                        </div>
                    </div>
                </div>
            </div>

            <button class="mobile-menu-btn">
                <i data-lucide="menu"></i>
            </button>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div class="mobile-menu">
        <div class="flex flex-col gap-4">
            <!-- Logged Out State -->
            <div id="mobile-logged-out-actions">
                <a href="products.html" class="nav-link" style="font-size: 1.1rem; padding: 0.5rem 0;">Shop</a>
                <a href="about.html" class="nav-link" style="font-size: 1.1rem; padding: 0.5rem 0;">About</a>
                <hr style="border-color: var(--border); margin: 0.5rem 0;">
                <a href="login.html" class="btn btn-ghost" style="text-align: center; width: 100%;">Log In</a>
                <a href="signup-select-university.html" class="btn btn-primary" style="text-align: center; width: 100%;">Sign Up</a>
            </div>
            
            <!-- Logged In State -->
            <div id="mobile-logged-in-actions" class="hidden">
                <a href="products.html" class="nav-link" style="font-size: 1.1rem; padding: 0.5rem 0;">Shop</a>
                <a href="about.html" class="nav-link" style="font-size: 1.1rem; padding: 0.5rem 0;">About</a>
                <hr style="border-color: var(--border); margin: 0.5rem 0;">
                <a href="sell.html" class="nav-link" style="font-size: 1.1rem; padding: 0.5rem 0;">Sell</a>
                <a href="messages.html" class="nav-link" style="font-size: 1.1rem; padding: 0.5rem 0;">Messages</a>
                <a href="saved-items.html" class="nav-link" style="font-size: 1.1rem; padding: 0.5rem 0;">Saved Items</a>
                <a href="profile.html" class="nav-link" style="font-size: 1.1rem; padding: 0.5rem 0;">Profile</a>
                <hr style="border-color: var(--border); margin: 0.5rem 0;">
                <button onclick="logout()" class="btn btn-outline" style="text-align: center; width: 100%;">Log Out</button>
            </div>
        </div>
    </div>

    <div class="container products-layout">
        <!-- Sidebar Filters -->
        <aside class="filters-sidebar">
            <div class="flex items-center justify-between" style="margin-bottom: 1.5rem;">
                <h3 style="font-family: var(--font-heading); font-weight: 700; font-size: 1.25rem;">Filters</h3>
                <button class="btn-ghost" style="font-size: 0.875rem; padding: 0.25rem 0.5rem;" onclick="clearAllFilters()">Clear All</button>
            </div>

            <!-- Category Filter -->
            <div class="filter-section">
                <div class="filter-title">Category <i data-lucide="chevron-down" style="width: 1rem;"></i></div>
                <div class="filter-group">
                    <select class="input" id="category-select">
                        <option value="all">All Categories</option>
                        <option value="Textbooks">Textbooks</option>
                        <option value="Electronics">Electronics</option>
                        <option value="Clothing">Clothing</option>
                        <option value="Furniture">Furniture</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
            </div>

            <!-- Price Filter -->
            <div class="filter-section">
                <div class="filter-title">Price Range</div>
                <div class="filter-group">
                    <input type="range" min="0" max="10000" value="5000" class="range-slider" id="price-range">
                    <div class="range-values">
                        <span>₦0</span>
                        <span id="price-value">₦5000</span>
                        <span>₦10000+</span>
                    </div>
                </div>
            </div>

            <!-- Condition Filter -->
            <div class="filter-section">
                <div class="filter-title">Condition</div>
                <div class="filter-group">
                    <label class="checkbox-label">
                        <input type="radio" name="condition" value="all" checked> Any
                    </label>
                    <label class="checkbox-label">
                        <input type="radio" name="condition" value="New"> New
                    </label>
                    <label class="checkbox-label">
                        <input type="radio" name="condition" value="Like New"> Like New
                    </label>
                    <label class="checkbox-label">
                        <input type="radio" name="condition" value="Good"> Good
                    </label>
                    <label class="checkbox-label">
                        <input type="radio" name="condition" value="Fair"> Fair
                    </label>
                </div>
            </div>

            <!-- Clothing Specific Filters (Hidden by default) -->
            <div class="filter-section hidden" id="clothing-filters">
                <!-- Sub-Category Filter -->
                <div class="filter-title">Clothing Type</div>
                <div class="filter-group">
                    <label class="checkbox-label"><input type="checkbox" name="sub-category" value="Shirts"> Shirts</label>
                    <label class="checkbox-label"><input type="checkbox" name="sub-category" value="Trousers"> Trousers</label>
                    <label class="checkbox-label"><input type="checkbox" name="sub-category" value="Dresses"> Dresses</label>
                    <label class="checkbox-label"><input type="checkbox" name="sub-category" value="Skirts"> Skirts</label>
                </div>

                <!-- Size Filter -->
                <div class="filter-title" style="margin-top: 1rem;">Size</div>
                <div class="filter-group">
                    <label class="checkbox-label"><input type="checkbox" name="size" value="XS"> XS</label>
                    <label class="checkbox-label"><input type="checkbox" name="size" value="S"> S</label>
                    <label class="checkbox-label"><input type="checkbox" name="size" value="M"> M</label>
                    <label class="checkbox-label"><input type="checkbox" name="size" value="L"> L</label>
                    <label class="checkbox-label"><input type="checkbox" name="size" value="XL"> XL</label>
                </div>

                <!-- Color Filter -->
                <div class="filter-title" style="margin-top: 1rem;">Color</div>
                <div class="filter-group">
                    <label class="checkbox-label"><input type="checkbox" name="color" value="Red"> Red</label>
                    <label class="checkbox-label"><input type="checkbox" name="color" value="Blue"> Blue</label>
                    <label class="checkbox-label"><input type="checkbox" name="color" value="Black"> Black</label>
                    <label class="checkbox-label"><input type="checkbox" name="color" value="White"> White</label>
                </div>
            </div>

            <button class="btn btn-primary" style="width: 100%; margin-top: 1rem;" onclick="updateClothingFilters()">Apply Filter</button>
        </aside>

        <!-- Main Content -->
        <main class="products-main">
            <!-- Banner -->
            <div class="products-banner">
                <div class="products-banner-overlay"></div>
                <div class="products-banner-content">
                    <h2 style="font-size: 2rem; font-weight: 800; margin-bottom: 0.5rem;">Sell Your Stuff, Fast!</h2>
                    <p style="margin-bottom: 1.5rem; opacity: 0.9;">Turn your old textbooks and gear into cash. It's
                        free to list!</p>
                    <a href="sell.html" class="btn btn-primary" style="background-color: white; color: black;">Start
                        Selling</a>
                </div>
            </div>

            <!-- List Header -->
            <div class="products-header">
                <div>
                    <h1 id="products-title" style="font-size: 1.5rem; font-weight: 700;">All Products</h1>
                    <p id="results-count" style="color: var(--muted); font-size: 0.9rem;">Showing 1-12 of 48 results</p>
                    <button id="view-all-btn" class="btn btn-outline" style="margin-top: 0.75rem; display: none;">
                        <i data-lucide="x" style="width: 1rem; margin-right: 0.5rem;"></i>
                        View All Products
                    </button>
                </div>
                <div class="flex items-center gap-2">
                    <!-- Mobile Filter Button -->
                    <button class="mobile-filter-btn" id="mobile-filter-btn" onclick="toggleFilterModal()">
                        <i data-lucide="sliders-horizontal" style="width: 1.25rem;"></i>
                    </button>
                    
                    <span style="font-size: 0.9rem; color: var(--muted);">Sort by:</span>
                    <select class="input" style="width: auto;" id="sort-select">
                        <option value="newest">Newest</option>
                        <option value="price-asc">Price: Low to High</option>
                        <option value="price-desc">Price: High to Low</option>
                    </select>
                </div>
            </div>

            <!-- Mobile Filter Modal -->
            <div class="filter-modal" id="filter-modal">
                <div class="filter-modal-overlay" onclick="closeFilterModal()"></div>
                <div class="filter-modal-content">
                    <div class="filter-modal-header">
                        <h2>Filters</h2>
                        <button class="filter-modal-close" onclick="closeFilterModal()">
                            <i data-lucide="x" style="width: 1.5rem;"></i>
                        </button>
                    </div>

                    <!-- Category Filter -->
                    <div class="filter-section">
                        <div class="filter-title">Category</div>
                        <div class="filter-group">
                            <select class="input" id="mobile-category-select">
                                <option value="all">All Categories</option>
                                <option value="Textbooks">Textbooks</option>
                                <option value="Electronics">Electronics</option>
                                <option value="Clothing">Clothing</option>
                                <option value="Furniture">Furniture</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>

                    <!-- Price Filter -->
                    <div class="filter-section">
                        <div class="filter-title">Price Range</div>
                        <div class="filter-group">
                            <input type="range" min="0" max="10000" value="5000" class="range-slider" id="mobile-price-range">
                            <div class="range-values">
                                <span>₦0</span>
                                <span id="mobile-price-value">₦5000</span>
                                <span>₦10000+</span>
                            </div>
                        </div>
                    </div>

                    <!-- Condition Filter -->
                    <div class="filter-section">
                        <div class="filter-title">Condition</div>
                        <div class="filter-group">
                            <label class="checkbox-label">
                                <input type="radio" name="mobile-condition" value="all" checked> Any
                            </label>
                            <label class="checkbox-label">
                                <input type="radio" name="mobile-condition" value="New"> New
                            </label>
                            <label class="checkbox-label">
                                <input type="radio" name="mobile-condition" value="Like New"> Like New
                            </label>
                            <label class="checkbox-label">
                                <input type="radio" name="mobile-condition" value="Good"> Good
                            </label>
                            <label class="checkbox-label">
                                <input type="radio" name="mobile-condition" value="Fair"> Fair
                            </label>
                        </div>
                    </div>

                    <!-- Mobile Clothing Specific Filters (Hidden by default) -->
                    <div class="filter-section hidden" id="mobile-clothing-filters">
                        <!-- Sub-Category Filter -->
                        <div class="filter-title">Clothing Type</div>
                        <div class="filter-group">
                            <label class="checkbox-label"><input type="checkbox" name="mobile-sub-category" value="Shirts"> Shirts</label>
                            <label class="checkbox-label"><input type="checkbox" name="mobile-sub-category" value="Trousers"> Trousers</label>
                            <label class="checkbox-label"><input type="checkbox" name="mobile-sub-category" value="Dresses"> Dresses</label>
                            <label class="checkbox-label"><input type="checkbox" name="mobile-sub-category" value="Skirts"> Skirts</label>
                        </div>

                        <!-- Size Filter -->
                        <div class="filter-title" style="margin-top: 1rem;">Size</div>
                        <div class="filter-group">
                            <label class="checkbox-label"><input type="checkbox" name="mobile-size" value="XS"> XS</label>
                            <label class="checkbox-label"><input type="checkbox" name="mobile-size" value="S"> S</label>
                            <label class="checkbox-label"><input type="checkbox" name="mobile-size" value="M"> M</label>
                            <label class="checkbox-label"><input type="checkbox" name="mobile-size" value="L"> L</label>
                            <label class="checkbox-label"><input type="checkbox" name="mobile-size" value="XL"> XL</label>
                        </div>

                        <!-- Color Filter -->
                        <div class="filter-title" style="margin-top: 1rem;">Color</div>
                        <div class="filter-group">
                            <label class="checkbox-label"><input type="checkbox" name="mobile-color" value="Red"> Red</label>
                            <label class="checkbox-label"><input type="checkbox" name="mobile-color" value="Blue"> Blue</label>
                            <label class="checkbox-label"><input type="checkbox" name="mobile-color" value="Black"> Black</label>
                            <label class="checkbox-label"><input type="checkbox" name="mobile-color" value="White"> White</label>
                        </div>
                    </div>

                    <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                        <button class="btn btn-primary" style="flex: 1;" onclick="applyMobileFilters()">Apply</button>
                        <button class="btn btn-ghost" style="flex: 1;" onclick="closeFilterModal()">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Product Grid -->
            <div class="product-grid">
                <!-- Product 1 -->
                <a href="product-detail.html" class="product-card">
                    <div class="product-image-container">
                        <img src="https://images.unsplash.com/photo-1544816155-12df9643f363?q=80&w=2000&auto=format&fit=crop"
                            alt="Product" class="product-image">
                        <button class="product-save-btn"><i data-lucide="bookmark" style="width: 1.25rem;"></i></button>
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">Engineering Mechanics</h3>
                        <span class="product-price">₦45.00</span>
                        <div class="product-meta">
                            <span class="meta-item"><i data-lucide="map-pin" style="width: 1rem;"></i> Library</span>
                        </div>
                    </div>
                </a>

                <!-- Product 2 -->
                <a href="product-detail.html" class="product-card">
                    <div class="product-image-container">
                        <img src="https://images.unsplash.com/photo-1505740420928-5e560c06d30e?q=80&w=2000&auto=format&fit=crop"
                            alt="Product" class="product-image">
                        <button class="product-save-btn"><i data-lucide="bookmark" style="width: 1.25rem;"></i></button>
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">Sony Headphones</h3>
                        <span class="product-price">₦180.00</span>
                        <div class="product-meta">
                            <span class="meta-item"><i data-lucide="map-pin" style="width: 1rem;"></i> Student
                                Center</span>
                        </div>
                    </div>
                </a>

                <!-- Product 3 -->
                <a href="product-detail.html" class="product-card">
                    <div class="product-image-container">
                        <img src="https://images.unsplash.com/photo-1585336261022-680e295ce3fe?q=80&w=2000&auto=format&fit=crop"
                            alt="Product" class="product-image">
                        <button class="product-save-btn"><i data-lucide="bookmark" style="width: 1.25rem;"></i></button>
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">MacBook Air M1</h3>
                        <span class="product-price">₦650.00</span>
                        <div class="product-meta">
                            <span class="meta-item"><i data-lucide="map-pin" style="width: 1rem;"></i> Dorm A</span>
                        </div>
                    </div>
                </a>

                <!-- Product 4 -->
                <a href="product-detail.html" class="product-card">
                    <div class="product-image-container">
                        <img src="https://images.unsplash.com/photo-1576566588028-4147f3842f27?q=80&w=2000&auto=format&fit=crop"
                            alt="Product" class="product-image">
                        <button class="product-save-btn"><i data-lucide="bookmark" style="width: 1.25rem;"></i></button>
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">Vintage Graphic Tee</h3>
                        <span class="product-price">₦15.00</span>
                        <div class="product-meta">
                            <span class="meta-item"><i data-lucide="map-pin" style="width: 1rem;"></i> Cafeteria</span>
                        </div>
                    </div>
                </a>

                <!-- Product 5 -->
                <a href="product-detail.html" class="product-card">
                    <div class="product-image-container">
                        <img src="https://images.unsplash.com/photo-1555041469-a586c61ea9bc?q=80&w=2000&auto=format&fit=crop"
                            alt="Product" class="product-image">
                        <button class="product-save-btn"><i data-lucide="bookmark" style="width: 1.25rem;"></i></button>
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">Green Sofa</h3>
                        <span class="product-price">$120.00</span>
                        <div class="product-meta">
                            <span class="meta-item"><i data-lucide="map-pin" style="width: 1rem;"></i> Off-campus</span>
                        </div>
                    </div>
                </a>

                <!-- Product 6 -->
                <a href="product-detail.html" class="product-card">
                    <div class="product-image-container">
                        <img src="https://images.unsplash.com/photo-1526170375885-4d8ecf77b99f?q=80&w=2000&auto=format&fit=crop"
                            alt="Product" class="product-image">
                        <button class="product-save-btn"><i data-lucide="bookmark" style="width: 1.25rem;"></i></button>
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">Polaroid Camera</h3>
                        <span class="product-price">$85.00</span>
                        <div class="product-meta">
                            <span class="meta-item"><i data-lucide="map-pin" style="width: 1rem;"></i> Arts Block</span>
                        </div>
                    </div>
                </a>
            </div>

            <!-- Pagination -->
            <div class="pagination">
                <button class="page-btn"><i data-lucide="chevron-left" style="width: 1rem;"></i></button>
                <button class="page-btn active">1</button>
                <button class="page-btn">2</button>
                <button class="page-btn">3</button>
                <span style="display: flex; align-items: center; color: var(--muted);">...</span>
                <button class="page-btn">8</button>
                <button class="page-btn"><i data-lucide="chevron-right" style="width: 1rem;"></i></button>
            </div>
        </main>
    </div>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <a href="index.html" class="logo">UniMarket</a>
                    <p>The trusted marketplace for university students. Buy, sell, and connect safely on campus.</p>
                    <div class="footer-socials">
                        <a href="#" class="social-btn"><i data-lucide="twitter" style="width: 1.2rem;"></i></a>
                        <a href="#" class="social-btn"><i data-lucide="facebook" style="width: 1.2rem;"></i></a>
                        <a href="#" class="social-btn"><i data-lucide="instagram" style="width: 1.2rem;"></i></a>
                        <a href="#" class="social-btn"><i data-lucide="github" style="width: 1.2rem;"></i></a>
                    </div>
                </div>

                <div class="footer-col">
                    <h4>Company</h4>
                    <ul>
                        <li><a href="#">About</a></li>
                        <li><a href="#">Features</a></li>
                        <li><a href="#">Works</a></li>
                        <li><a href="#">Career</a></li>
                    </ul>
                </div>

                <div class="footer-col">
                    <h4>Help</h4>
                    <ul>
                        <li><a href="#">Customer Support</a></li>
                        <li><a href="#">Delivery Details</a></li>
                        <li><a href="#">Terms & Conditions</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                    </ul>
                </div>

                <div class="footer-col">
                    <h4>FAQ</h4>
                    <ul>
                        <li><a href="#">Account</a></li>
                        <li><a href="#">Manage Deliveries</a></li>
                        <li><a href="#">Orders</a></li>
                        <li><a href="#">Payments</a></li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p>UniMarket © 2000-2023, All Rights Reserved</p>
                <div class="payment-methods flex gap-4">
                    <div style="width: 40px; height: 25px; background: #f0f0f0; border-radius: 4px;"></div>
                    <div style="width: 40px; height: 25px; background: #f0f0f0; border-radius: 4px;"></div>
                    <div style="width: 40px; height: 25px; background: #f0f0f0; border-radius: 4px;"></div>
                </div>
            </div>
        </div>
    </footer>
    <script src="js/app.js"></script>
    <script src="js/products.js"></script>
    <script>
        // Clothing filter visibility for DESKTOP and MOBILE
        const categorySelect = document.getElementById('category-select');
        const clothingFilters = document.getElementById('clothing-filters');
        const mobileCategorySelect = document.getElementById('mobile-category-select');
        const mobileClothingFilters = document.getElementById('mobile-clothing-filters');
        const priceRange = document.getElementById('price-range');
        const priceValue = document.getElementById('price-value');

        if (categorySelect && clothingFilters) {
            categorySelect.addEventListener('change', (e) => {
                // Show/hide clothing-specific filters on desktop
                if (e.target.value === 'Clothing') {
                    clothingFilters.classList.remove('hidden');
                } else {
                    clothingFilters.classList.add('hidden');
                }
                // Update filter and fetch products
                updateCategory(e.target.value);
            });
        }

        if (mobileCategorySelect && mobileClothingFilters) {
            mobileCategorySelect.addEventListener('change', (e) => {
                // Show/hide clothing-specific filters on mobile
                if (e.target.value === 'Clothing') {
                    mobileClothingFilters.classList.remove('hidden');
                } else {
                    mobileClothingFilters.classList.add('hidden');
                }
            });
        }

        if (priceRange && priceValue) {
            priceRange.addEventListener('input', (e) => {
                priceValue.textContent = `₦${e.target.value}`;
                updatePriceRange(0, parseInt(e.target.value));
            });
        }

        // Clothing filter listeners (Size, Color, Sub-Category checkboxes) - DESKTOP
        const sizeCheckboxes = document.querySelectorAll('input[name="size"]');
        const colorCheckboxes = document.querySelectorAll('input[name="color"]');
        const subCategoryCheckboxes = document.querySelectorAll('input[name="sub-category"]');
        
        sizeCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', updateClothingFilters);
        });
        
        colorCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', updateClothingFilters);
        });
        
        subCategoryCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', updateClothingFilters);
        });

        // Clothing filter listeners for MOBILE
        const mobileSizeCheckboxes = document.querySelectorAll('input[name="mobile-size"]');
        const mobileColorCheckboxes = document.querySelectorAll('input[name="mobile-color"]');
        const mobileSubCategoryCheckboxes = document.querySelectorAll('input[name="mobile-sub-category"]');
        
        mobileSizeCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                // Mobile filters will be applied when user clicks Apply button
            });
        });
        
        mobileColorCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                // Mobile filters will be applied when user clicks Apply button
            });
        });
        
        mobileSubCategoryCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                // Mobile filters will be applied when user clicks Apply button
            });
        });

        // Condition filter listeners
        const conditionRadios = document.querySelectorAll('input[name="condition"]');
        conditionRadios.forEach(radio => {
            radio.addEventListener('change', (e) => {
                updateCondition(e.target.value);
            });
        });

        // Sort dropdown listener
        const sortSelect = document.getElementById('sort-select');
        if (sortSelect) {
            sortSelect.addEventListener('change', (e) => {
                updateSort(e.target.value);
            });
        }

        // Handle search query and category from URL
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const searchQuery = urlParams.get('q');
            const categoryFilter = urlParams.get('category');

            const pageTitle = document.querySelector('.products-header h1');
            const resultsText = document.querySelector('.products-header p');
            const searchInput = document.querySelector('.search-bar input');

            if (searchQuery) {
                if (pageTitle) pageTitle.textContent = `Results for "${searchQuery}"`;
                if (searchInput) searchInput.value = searchQuery;
                filterProducts(searchQuery, 'search');
            }

            if (categoryFilter) {
                if (pageTitle) pageTitle.textContent = categoryFilter;
                if (categorySelect) categorySelect.value = categoryFilter.toLowerCase();
                filterProducts(categoryFilter, 'category');
            }
        });

        function filterProducts(query, type) {
            const productCards = document.querySelectorAll('.product-card');
            const lowerQuery = query.toLowerCase();
            let visibleCount = 0;

            productCards.forEach(card => {
                const name = card.querySelector('.product-name')?.textContent.toLowerCase() || '';
                // For category, you'd also check a data-category attribute
                const matches = name.includes(lowerQuery);

                if (matches) {
                    card.style.display = '';
                    visibleCount++;
                } else {
                    card.style.display = 'none';
                }
            });

            const resultsText = document.querySelector('.products-header p');
            if (resultsText) {
                if (visibleCount === 0) {
                    resultsText.textContent = 'No products found';
                    showEmptyState(query);
                } else {
                    resultsText.textContent = `Showing ${visibleCount} result${visibleCount !== 1 ? 's' : ''}`;
                }
            }
        }

        function showEmptyState(query) {
            const productGrid = document.querySelector('.product-grid');
            const allHidden = productGrid.querySelectorAll('.product-card:not([style*="display: none"])').length === 0;

            if (productGrid && allHidden) {
                productGrid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div style="width: 60px; height: 60px; background: var(--secondary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem;">
                            <i data-lucide="search" style="width: 24px; height: 24px; color: var(--muted);"></i>
                        </div>
                        <h3 class="empty-state-title">No results for "${query}"</h3>
                        <p class="empty-state-description">Try searching for something else or browse all products.</p>
                        <a href="products.html" class="btn btn-primary">View All Products</a>
                    </div>
                `;
                lucide.createIcons();
            }
        }
    </script>

    <!-- Mobile Filter Modal Script -->
    <script>
        /**
         * Toggle the mobile filter modal open/closed
         */
        function toggleFilterModal() {
            const modal = document.getElementById('filter-modal');
            modal.classList.toggle('open');
            // Prevent body scroll when modal is open
            if (modal.classList.contains('open')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = '';
            }
        }

        /**
         * Close the mobile filter modal
         */
        function closeFilterModal() {
            const modal = document.getElementById('filter-modal');
            modal.classList.remove('open');
            document.body.style.overflow = '';
        }

        /**
         * Apply filters from mobile modal
         */
        function applyMobileFilters() {
            // Get selected values from mobile filter inputs
            const category = document.getElementById('mobile-category-select').value;
            const condition = document.querySelector('input[name="mobile-condition"]:checked').value;
            const priceRange = document.getElementById('mobile-price-range').value;

            // Get mobile clothing-specific filters
            const mobileSubCategoryCheckboxes = document.querySelectorAll('input[name="mobile-sub-category"]:checked');
            const mobileSizeCheckboxes = document.querySelectorAll('input[name="mobile-size"]:checked');
            const mobileColorCheckboxes = document.querySelectorAll('input[name="mobile-color"]:checked');

            const mobileSubCategories = Array.from(mobileSubCategoryCheckboxes).map(cb => cb.value);
            const mobileSizes = Array.from(mobileSizeCheckboxes).map(cb => cb.value);
            const mobileColors = Array.from(mobileColorCheckboxes).map(cb => cb.value);

            // Update currentFilters (from products.js)
            if (typeof currentFilters !== 'undefined') {
                currentFilters.category = category === 'all' ? '' : category;
                currentFilters.condition = condition === 'all' ? '' : condition;
                currentFilters.maxPrice = parseInt(priceRange);
                currentFilters.page = 1;
                
                // Update clothing-specific filters
                currentFilters.subCategories = mobileSubCategories;
                currentFilters.sizes = mobileSizes;
                currentFilters.colors = mobileColors;

                // Fetch products with new filters
                if (typeof fetchProducts === 'function') {
                    fetchProducts();
                }
            }

            // Close the modal
            closeFilterModal();
        }

        // Update price display when slider changes
        document.addEventListener('DOMContentLoaded', () => {
            const mobileSlider = document.getElementById('mobile-price-range');
            if (mobileSlider) {
                mobileSlider.addEventListener('input', (e) => {
                    document.getElementById('mobile-price-value').textContent = '₦' + e.target.value;
                });
            }

            // Re-initialize Lucide icons for the modal
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        });
    </script>
</body>

</html>